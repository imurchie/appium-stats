'use strict';

var _slicedToArray = require('babel-runtime/helpers/sliced-to-array')['default'];

var _Symbol = require('babel-runtime/core-js/symbol')['default'];

var _getIterator = require('babel-runtime/core-js/get-iterator')['default'];

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _interopRequireWildcard = require('babel-runtime/helpers/interop-require-wildcard')['default'];

var _indexJs = require('../index.js');

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _os = require('os');

var _os2 = _interopRequireDefault(_os);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _teen_process = require('teen_process');

var teen_process = _interopRequireWildcard(_teen_process);

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

_chai2['default'].should();

var sandbox = null;
var SANDBOX = _Symbol();
var mocks = {};
var libs = { teen_process: teen_process, os: _os2['default'], system: _indexJs.system };

describe('system', function () {
  describe('isX functions', function () {
    it('should correctly return Windows System if it is a Windows', function () {
      var osMock = _sinon2['default'].mock(_os2['default']);
      osMock.expects('type').returns('Windows_NT');
      _indexJs.system.isWindows().should.equal['true'];
      osMock.verify();
      osMock.restore();
    });

    it('should correctly return Mac if it is a Mac', function () {
      var osMock = _sinon2['default'].mock(_os2['default']);
      osMock.expects('type').returns('Darwin');
      _indexJs.system.isMac().should.equal['true'];
      osMock.verify();
      osMock.restore();
    });

    it('should correctly return Linux if it is a Linux', function () {
      var osMock = _sinon2['default'].mock(_os2['default']);
      osMock.expects('type').twice().returns('Linux');
      _indexJs.system.isLinux().should.equal['true'];
      osMock.verify();
      osMock.restore();
    });
  });

  describe('architecture', function () {
    beforeEach(function () {
      sandbox = _sinon2['default'].sandbox.create();
      mocks[SANDBOX] = sandbox;
      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = _getIterator(_lodash2['default'].pairs(libs)), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var _step$value = _slicedToArray(_step.value, 2);

          var key = _step$value[0];
          var value = _step$value[1];

          mocks[key] = sandbox.mock(value);
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator['return']) {
            _iterator['return']();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }
    });

    afterEach(function () {
      sandbox.restore();
    });

    it('should return correct architecture if it is a 64 bit Mac/Linux', function callee$2$0() {
      var arch;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            mocks.os.expects('type').thrice().returns('Darwin');
            mocks.teen_process.expects('exec').once().withExactArgs('uname', ['-m']).returns({ stdout: 'x86_64' });
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_indexJs.system.arch());

          case 4:
            arch = context$3$0.sent;

            arch.should.equal('64');
            mocks[SANDBOX].verify();

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });

    it('should return correct architecture if it is a 32 bit Mac/Linux', function callee$2$0() {
      var arch;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            mocks.os.expects('type').twice().returns('Linux');
            mocks.teen_process.expects('exec').once().withExactArgs('uname', ['-m']).returns({ stdout: 'i686' });
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_indexJs.system.arch());

          case 4:
            arch = context$3$0.sent;

            arch.should.equal('32');
            mocks[SANDBOX].verify();

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });

    it('should return correct architecture if it is a 64 bit Windows', function callee$2$0() {
      var arch;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            mocks.os.expects('type').thrice().returns('Windows_NT');
            mocks.system.expects('isOSWin64').once().returns(true);
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_indexJs.system.arch());

          case 4:
            arch = context$3$0.sent;

            arch.should.equal('64');
            mocks[SANDBOX].verify();

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });

    it('should return correct architecture if it is a 32 bit Windows', function callee$2$0() {
      var arch;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            mocks.os.expects('type').thrice().returns('Windows_NT');
            mocks.system.expects('isOSWin64').once().returns(false);
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(_indexJs.system.arch());

          case 4:
            arch = context$3$0.sent;

            arch.should.equal('32');
            mocks[SANDBOX].verify();

          case 7:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });

  it('should know architecture', function () {
    return _indexJs.system.arch();
  });
});
//# sourceMappingURL=data:application/json;base64,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QztBQUN4RCxpQkFBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDOzs2Q0FDdEMsZ0JBQU8sSUFBSSxFQUFFOzs7QUFBMUIsZ0JBQUk7O0FBQ1IsZ0JBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3hCLGlCQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7S0FDekIsQ0FBQyxDQUFDOztBQUVILE1BQUUsQ0FBQyw4REFBOEQsRUFBRTtVQUc3RCxJQUFJOzs7O0FBRlIsaUJBQUssQ0FBQyxFQUFFLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUN4RCxpQkFBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDOzs2Q0FDdkMsZ0JBQU8sSUFBSSxFQUFFOzs7QUFBMUIsZ0JBQUk7O0FBQ1IsZ0JBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3hCLGlCQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7Ozs7Ozs7S0FDekIsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDOztBQUVILElBQUUsQ0FBQywwQkFBMEIsRUFBRSxZQUFNO0FBQ25DLFdBQU8sZ0JBQU8sSUFBSSxFQUFFLENBQUM7R0FDdEIsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6InRlc3Qvc3lzdGVtLXNwZWNzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBzeXN0ZW0gfSBmcm9tICcuLi9pbmRleC5qcyc7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCBvcyBmcm9tICdvcyc7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuaW1wb3J0ICogYXMgdGVlbl9wcm9jZXNzIGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5jaGFpLnNob3VsZCgpO1xuXG5sZXQgc2FuZGJveCA9IG51bGw7XG5sZXQgU0FOREJPWCA9IFN5bWJvbCgpO1xubGV0IG1vY2tzID0ge307XG5sZXQgbGlicyA9IHt0ZWVuX3Byb2Nlc3MsIG9zLCBzeXN0ZW19O1xuXG5kZXNjcmliZSgnc3lzdGVtJywgZnVuY3Rpb24gKCkge1xuICBkZXNjcmliZSgnaXNYIGZ1bmN0aW9ucycsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGNvcnJlY3RseSByZXR1cm4gV2luZG93cyBTeXN0ZW0gaWYgaXQgaXMgYSBXaW5kb3dzJywgZnVuY3Rpb24gKCkge1xuICAgICAgbGV0IG9zTW9jayA9IHNpbm9uLm1vY2sob3MpO1xuICAgICAgb3NNb2NrLmV4cGVjdHMoJ3R5cGUnKS5yZXR1cm5zKCdXaW5kb3dzX05UJyk7XG4gICAgICBzeXN0ZW0uaXNXaW5kb3dzKCkuc2hvdWxkLmVxdWFsLnRydWU7XG4gICAgICBvc01vY2sudmVyaWZ5KCk7XG4gICAgICBvc01vY2sucmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjb3JyZWN0bHkgcmV0dXJuIE1hYyBpZiBpdCBpcyBhIE1hYycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBvc01vY2sgPSBzaW5vbi5tb2NrKG9zKTtcbiAgICAgIG9zTW9jay5leHBlY3RzKCd0eXBlJykucmV0dXJucygnRGFyd2luJyk7XG4gICAgICBzeXN0ZW0uaXNNYWMoKS5zaG91bGQuZXF1YWwudHJ1ZTtcbiAgICAgIG9zTW9jay52ZXJpZnkoKTtcbiAgICAgIG9zTW9jay5yZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNvcnJlY3RseSByZXR1cm4gTGludXggaWYgaXQgaXMgYSBMaW51eCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBvc01vY2sgPSBzaW5vbi5tb2NrKG9zKTtcbiAgICAgIG9zTW9jay5leHBlY3RzKCd0eXBlJykudHdpY2UoKS5yZXR1cm5zKCdMaW51eCcpO1xuICAgICAgc3lzdGVtLmlzTGludXgoKS5zaG91bGQuZXF1YWwudHJ1ZTtcbiAgICAgIG9zTW9jay52ZXJpZnkoKTtcbiAgICAgIG9zTW9jay5yZXN0b3JlKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdhcmNoaXRlY3R1cmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBzYW5kYm94ID0gc2lub24uc2FuZGJveC5jcmVhdGUoKTtcbiAgICAgIG1vY2tzW1NBTkRCT1hdID0gc2FuZGJveDtcbiAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBfLnBhaXJzKGxpYnMpKSB7XG4gICAgICAgIG1vY2tzW2tleV0gPSBzYW5kYm94Lm1vY2sodmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAgIHNhbmRib3gucmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBhcmNoaXRlY3R1cmUgaWYgaXQgaXMgYSA2NCBiaXQgTWFjL0xpbnV4JywgYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICBtb2Nrcy5vcy5leHBlY3RzKCd0eXBlJykudGhyaWNlKCkucmV0dXJucygnRGFyd2luJyk7XG4gICAgICBtb2Nrcy50ZWVuX3Byb2Nlc3MuZXhwZWN0cygnZXhlYycpLm9uY2UoKS53aXRoRXhhY3RBcmdzKCd1bmFtZScsIFsnLW0nXSkucmV0dXJucyh7c3Rkb3V0OiAneDg2XzY0J30pO1xuICAgICAgbGV0IGFyY2ggPSBhd2FpdCBzeXN0ZW0uYXJjaCgpO1xuICAgICAgYXJjaC5zaG91bGQuZXF1YWwoJzY0Jyk7XG4gICAgICBtb2Nrc1tTQU5EQk9YXS52ZXJpZnkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgYXJjaGl0ZWN0dXJlIGlmIGl0IGlzIGEgMzIgYml0IE1hYy9MaW51eCcsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgbW9ja3Mub3MuZXhwZWN0cygndHlwZScpLnR3aWNlKCkucmV0dXJucygnTGludXgnKTtcbiAgICAgIG1vY2tzLnRlZW5fcHJvY2Vzcy5leHBlY3RzKCdleGVjJykub25jZSgpLndpdGhFeGFjdEFyZ3MoJ3VuYW1lJywgWyctbSddKS5yZXR1cm5zKHtzdGRvdXQ6ICdpNjg2J30pO1xuICAgICAgbGV0IGFyY2ggPSBhd2FpdCBzeXN0ZW0uYXJjaCgpO1xuICAgICAgYXJjaC5zaG91bGQuZXF1YWwoJzMyJyk7XG4gICAgICBtb2Nrc1tTQU5EQk9YXS52ZXJpZnkoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgYXJjaGl0ZWN0dXJlIGlmIGl0IGlzIGEgNjQgYml0IFdpbmRvd3MnLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIG1vY2tzLm9zLmV4cGVjdHMoJ3R5cGUnKS50aHJpY2UoKS5yZXR1cm5zKCdXaW5kb3dzX05UJyk7XG4gICAgICBtb2Nrcy5zeXN0ZW0uZXhwZWN0cygnaXNPU1dpbjY0Jykub25jZSgpLnJldHVybnModHJ1ZSk7XG4gICAgICBsZXQgYXJjaCA9IGF3YWl0IHN5c3RlbS5hcmNoKCk7XG4gICAgICBhcmNoLnNob3VsZC5lcXVhbCgnNjQnKTtcbiAgICAgIG1vY2tzW1NBTkRCT1hdLnZlcmlmeSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBhcmNoaXRlY3R1cmUgaWYgaXQgaXMgYSAzMiBiaXQgV2luZG93cycsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgbW9ja3Mub3MuZXhwZWN0cygndHlwZScpLnRocmljZSgpLnJldHVybnMoJ1dpbmRvd3NfTlQnKTtcbiAgICAgIG1vY2tzLnN5c3RlbS5leHBlY3RzKCdpc09TV2luNjQnKS5vbmNlKCkucmV0dXJucyhmYWxzZSk7XG4gICAgICBsZXQgYXJjaCA9IGF3YWl0IHN5c3RlbS5hcmNoKCk7XG4gICAgICBhcmNoLnNob3VsZC5lcXVhbCgnMzInKTtcbiAgICAgIG1vY2tzW1NBTkRCT1hdLnZlcmlmeSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGtub3cgYXJjaGl0ZWN0dXJlJywgKCkgPT4ge1xuICAgIHJldHVybiBzeXN0ZW0uYXJjaCgpO1xuICB9KTtcbn0pO1xuIl19